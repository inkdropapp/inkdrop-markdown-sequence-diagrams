{"version":3,"sources":["../src/index.js"],"names":["Diagram","React","Component","constructor","props","e","setState","error","state","componentDidMount","updateSVG","componentDidUpdate","render","code","children","options","theme","text","el","container","handleError","svg","querySelector","w","getAttribute","h","setAttribute","PropTypes","node","module","exports","activate","MDEPreview","inkdrop","components","classes","remarkCodeComponents","deactivate","flowchart"],"mappings":";;AAAA;;AACA;;AACA;;;;;;AAEA,MAAMA,OAAN,SAAsBC,eAAMC,SAA5B,CAAsC;AAIpCC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;;AADiB,yCA4CLC,CAAC,IAAI;AACjB,WAAKC,QAAL,CAAc;AAAEC,QAAAA,KAAK,EAAEF;AAAT,OAAd;AACD,KA9CkB;;AAEjB,SAAKG,KAAL,GAAa;AAAED,MAAAA,KAAK,EAAE;AAAT,KAAb;AACD;;AACDE,EAAAA,iBAAiB,GAAG;AAClB,SAAKC,SAAL;AACD;;AACDC,EAAAA,kBAAkB,GAAG;AACnB,SAAKD,SAAL;AACD;;AACDE,EAAAA,MAAM,GAAG;AACP,UAAM;AAAEL,MAAAA;AAAF,QAAY,KAAKC,KAAvB;AACA,UAAMK,IAAI,GAAG,KAAKT,KAAL,CAAWU,QAAX,CAAoB,CAApB,CAAb;AACA,UAAMC,OAAO,GAAG;AAAEC,MAAAA,KAAK,EAAE;AAAT,KAAhB;;AACA,QAAIT,KAAJ,EAAW;AACT,aACE;AAAK,QAAA,SAAS,EAAC;AAAf,SACE;AAAK,QAAA,SAAS,EAAC;AAAf,iDADF,EAEE,wCAAIA,KAAK,CAACU,IAAV,CAFF,CADF;AAMD,KAPD,MAOO;AACL,aACE;AAAK,QAAA,SAAS,EAAC,kBAAf;AAAkC,QAAA,GAAG,EAAEC,EAAE,IAAK,KAAKC,SAAL,GAAiBD;AAA/D,SACE,6BAAC,6BAAD;AACE,QAAA,KAAK,EAAEL,IADT;AAEE,QAAA,OAAO,EAAEE,OAFX;AAGE,QAAA,OAAO,EAAE,KAAKK;AAHhB,QADF,CADF;AASD;AACF;;AACDV,EAAAA,SAAS,GAAG;AACV,QAAI,KAAKS,SAAT,EAAoB;AAClB,YAAME,GAAG,GAAG,KAAKF,SAAL,CAAeG,aAAf,CAA6B,KAA7B,CAAZ;;AACA,UAAID,GAAJ,EAAS;AACP,cAAME,CAAC,GAAGF,GAAG,CAACG,YAAJ,CAAiB,OAAjB,CAAV;AACA,cAAMC,CAAC,GAAGJ,GAAG,CAACG,YAAJ,CAAiB,QAAjB,CAAV;AACAH,QAAAA,GAAG,CAACK,YAAJ,CAAiB,SAAjB,EAA6B,OAAMH,CAAE,IAAGE,CAAE,EAA1C;AACAJ,QAAAA,GAAG,CAACK,YAAJ,CAAiB,qBAAjB,EAAwC,eAAxC;AACD;AACF;AACF;;AA/CmC;;gBAAhC1B,O,eACe;AACjBc,EAAAA,QAAQ,EAAEa,mBAAUC;AADH,C;;AAoDrBC,MAAM,CAACC,OAAP,GAAiB;AACfC,EAAAA,QAAQ,GAAG;AACT,UAAM;AAAEC,MAAAA;AAAF,QAAiBC,OAAO,CAACC,UAAR,CAAmBC,OAA1C;;AACA,QAAIH,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAACI,oBAAX,CAAgC,UAAhC,IAA8CpC,OAA9C;AACD;AACF,GANc;;AAQfqC,EAAAA,UAAU,GAAG;AACX,UAAM;AAAEL,MAAAA;AAAF,QAAiBC,OAAO,CAACC,UAAR,CAAmBC,OAA1C;;AACA,QAAIH,UAAJ,EAAgB;AACdA,MAAAA,UAAU,CAACI,oBAAX,CAAgCE,SAAhC,GAA4C,IAA5C;AACD;AACF;;AAbc,CAAjB","sourcesContent":["import { React } from 'inkdrop'\nimport PropTypes from 'prop-types'\nimport SequenceDiagram from 'react-sequence-diagram'\n\nclass Diagram extends React.Component {\n  static propTypes = {\n    children: PropTypes.node\n  }\n  constructor(props) {\n    super(props)\n    this.state = { error: null }\n  }\n  componentDidMount() {\n    this.updateSVG()\n  }\n  componentDidUpdate() {\n    this.updateSVG()\n  }\n  render() {\n    const { error } = this.state\n    const code = this.props.children[0]\n    const options = { theme: 'simple' }\n    if (error) {\n      return (\n        <div className=\"ui error message\">\n          <div className=\"header\">Failed to render the sequence diagram</div>\n          <p>{error.text}</p>\n        </div>\n      )\n    } else {\n      return (\n        <div className=\"sequence-diagram\" ref={el => (this.container = el)}>\n          <SequenceDiagram\n            input={code}\n            options={options}\n            onError={this.handleError}\n          />\n        </div>\n      )\n    }\n  }\n  updateSVG() {\n    if (this.container) {\n      const svg = this.container.querySelector('svg')\n      if (svg) {\n        const w = svg.getAttribute('width')\n        const h = svg.getAttribute('height')\n        svg.setAttribute('viewBox', `0 0 ${w} ${h}`)\n        svg.setAttribute('preserveAspectRatio', 'xMidYMid meet')\n      }\n    }\n  }\n  handleError = e => {\n    this.setState({ error: e })\n  }\n}\n\nmodule.exports = {\n  activate() {\n    const { MDEPreview } = inkdrop.components.classes\n    if (MDEPreview) {\n      MDEPreview.remarkCodeComponents['sequence'] = Diagram\n    }\n  },\n\n  deactivate() {\n    const { MDEPreview } = inkdrop.components.classes\n    if (MDEPreview) {\n      MDEPreview.remarkCodeComponents.flowchart = null\n    }\n  }\n}\n"],"file":"index.js"}